![image-20210201194049970](https://gitee.com/zisuu/picture/raw/master/img/20210201194050.png)

## 1.选取主节点

![image-20210201194118864](https://gitee.com/zisuu/picture/raw/master/img/20210201194119.png)

## 2.选取集群元信息

![image-20210201194354399](https://gitee.com/zisuu/picture/raw/master/img/20210201194354.png)

![image-20210201194402030](https://gitee.com/zisuu/picture/raw/master/img/20210201194402.png)

## 3 allocation过程

![image-20210201194823216](https://gitee.com/zisuu/picture/raw/master/img/20210201194823.png)

### 3.1选取主分片

![image-20210201194937195](https://gitee.com/zisuu/picture/raw/master/img/20210201194937.png)



### 3.2 选副分片

![image-20210201195444902](https://gitee.com/zisuu/picture/raw/master/img/20210201195445.png)

## 4.index recovery

![image-20210201195521747](https://gitee.com/zisuu/picture/raw/master/img/20210201195521.png)

![image-20210201200104249](https://gitee.com/zisuu/picture/raw/master/img/20210201200104.png)















































